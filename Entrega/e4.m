clear allclcclf## 1. Cargamos las imagenesimg_centro = imread ("./img/Berserk_centro.png");img_izda = imread ("./img/Berserk_izquierda.png");img_dcha = imread ("./img/Berserk_derecha.png");## 2. Ampliamos el tamaño de las imagenesf = rows(img_centro);c = columns(img_centro);size(img_centro);img_centro = [zeros(f,c) img_centro zeros(f,c)];img_izda = [img_izda zeros(f,c) zeros(f,c)];img_dcha = [zeros(f,c) zeros(f,c) img_dcha];## 3. Obtenemos los puntos de referencia de las imagenes%puntos imagen centroC1_iz = [340 796]; %interior arribaC2_iz = [340 761]; %exterior arribaC3_iz = [710 795]; %interior abajoC4_iz = [710 760]; %exterior abajoC1_dcha=[337 1460]; %interior arribaC2_dcha=[337 1485]; %exterior arribaC3_dcha=[713 1461]; %interior abajoC4_dcha=[713 1494]; %exterior abajoC_IZ = [C1_iz;C2_iz;C3_iz;C4_iz];C_DCHA = [C1_dcha;C2_dcha;C3_dcha;C4_dcha];%puntos imagen derechaD1_dcha=[367 1889]; %interior arribaD2_dcha=[369 1917]; %exterior arribaD3_dcha=[697 1901]; %interior abajoD4_dcha=[691 1930]; %exterior abajoD_DCHA = [D1_dcha;D2_dcha;D3_dcha;D4_dcha];%puntos imagen izquierdaI1_iz = [360 442]; %interior arribaI2_iz = [360 414]; %exterior arribaI3_iz = [690 409]; %interior abajoI4_iz = [682 382]; %exterior abajoI_IZ = [I1_iz;I2_iz;I3_iz;I4_iz];## 4. Calculamos y aplicamos las homografíasH_D = homografia(C_DCHA,D_DCHA);H_I = homografia(C_IZ, I_IZ);% IZQUIERDAf = rows(img_izda);c = columns(img_izda);I_IMG = zeros(f,c);for i = 1:f    for j = 1:c      r = H_I * [i, j, 1]';      r = r / r(end);      x = round(r(1));      y = round(r(2));      if (x>0 && y>0 && x<=f && y<=c)        I_IMG(i,j) = img_izda(x,y);      endif    endforendfor% DERECHAf = rows(img_dcha);c = columns(img_dcha);D_IMG = zeros(f,c);for i = 1:f    for j = 1:c      r = H_D * [i, j, 1]';      r = r / r(end);      x = round(r(1));      y = round(r(2));      if (x>0 && y>0 && x<=f && y<=c)        D_IMG(i,j) = img_dcha(x,y);      endif    endforendfor## 4. Recorremos las imagenes para pintarlas en su posiciónf = rows(img_centro);c = columns(img_centro);for i = 1:f    for j = 1:c      if(img_centro(i,j) == 0)        if(j < c/2)          img_centro(i,j) = I_IMG(i,j);        else           img_centro(i,j) = D_IMG(i,j);        endif      endif     endforendfor## 5. Pintamos la imagen resultanteimshow(uint8(img_centro));